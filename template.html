<!doctype html>
<html>
	<head>
		<title>{{title}}</title>
		<meta charset="UTF-8" />
		<meta name="viewport" content="width=device-width, initial-scale=1.0" />
		<link rel="stylesheet" href="/metap.css" />
		<style>
			/* All styles from the Obsidian app are injected here */
			{{styles}}

			/* Overrides for the served page context */
			body {
			    max-width: 50vw;
			    margin: auto;
			    padding: 2em;
				overflow-y: scroll;
			}
			blockquote {
				backdrop-filter: sepia(1);
    			padding-right: 0.5em;
    			padding-left: 0.5em;
    			padding-top: 0.2em;
    			padding-bottom: 0.2em;
    			border-radius: 0.5em !important;
			}
			img, video { max-width: 100%; height: auto; }
			.is-unresolved { color: var(--text-error, #cc2222); text-decoration: line-through; }
		</style>
	</head>
	<body class="{{themeClass}}">
		<h1>{{title}}</h1>
		{{body}}
		<script src="/metap.js"></script>
		<script>
			document.addEventListener("DOMContentLoaded", async () => {
				const response = await fetch("/search-data.json");
				const notes = await response.json();
				const commands = notes.map((note) => ({
					title: note.path,
					lambda: () => {
						window.location.href = `/${encodeURI(note.path)}`;
					},
				}));
				if (window.metaP) {
					// Set properties on the existing instance before binding
					window.metaP.maxCommands = 10;
					window.metaP.maxCommandTitleLength = 100;
					window.metaP.bind(commands);
				}
			});
		</script>
	</body>
</html>
